---
title: Bitrix ORM  - простейшие операции выборки данных и DataManager
description: Рассмотрим базовые моменты выборки, фильтрации на примере работы с инфоблоками, а так же базовые понятия сущностей и класс DataManager
date: 2023-07-06
tags:
  - bitrix
layout: layouts/post.njk
---

Несколько лет назад разработчики Bitrix решили унифицировать работу с данными и в новом ядре `D7` реализовали `ORM`.

С приходом `ORM` появились следующие понятия:

* Сущность ( `Entity` ) - простым языком это таблица в базе данных
* Поля сущности  - столбцы в таблице

А также абстрактный класс `DataManager` который обязывает своих наследников реализовать 2 метода `getTableName` и `getMap`.

Метод `getTableName` должен возвращать название таблицы с которой нужно работать, а `getMap` описание столбцов таблицы.

Работу с кастомными сущностями подробнее мы рассмотрим в следующей статье. А сегодня научимся делать простые выборки данных из таблицы инфоблоков.

Прежде всего, не забываем импортировать модуль для работы

```php
\Bitrix\Main\Loader::includeModule('iblock');
```

За работу с инфоблоками отвечает сущность `IblockTable` . Она также наследуется от  `DataManager` и поэтому имеет метод `getList`.

Для выборки всех данных выполним запрос без параметров

```php
$query = \Bitrix\Iblock\IblockTable::getList();

while ($response = $query->fetch()) {
	var_dump(response);
}
```

На примере можно увидеть, что получение данных можно как и раньше осуществить с помощью `fetch` . Так же доступны и другие методы, которые более подробно будет освещены в следующих статьях.

Так как разработчики хотели упростить переход на новый API, синтаксис фильтров, выборки данных практически такой же как и в старом методе `getList`.

Для примера рассмотрим получение инфоблоков, чей `id` больше 2

```php
$query = \Bitrix\Iblock\IblockTable::getList([
	'filter' => [
		'>ID' => 2
	]
]);

while ($response = $query->fetch()) {
	var_dump(response);
}
```

Так же мы можем указать поля, которые нужно получить

```php
$query = \Bitrix\Iblock\IblockTable::getList([
	'filter' => [
		'>ID' => 2
	],
	'select' => [
		'ID',
		'NAME'
	],

]);

while ($response = $query->fetch()) {
	var_dump(response);
}
```

Существует и возможность создать алиасы для полей, например мы может вместо `NAME` получать `TITLE`

```php
$query = \Bitrix\Iblock\IblockTable::getList([
	'select' => [
		'ID',
		'TITLE' => 'NAME'
	],

]);

while ($response = $query->fetch()) {
	var_dump(response);
}
```

Как и в старом API можно использовать следующие параметры:

- `order`
- `select`
- `filter`
- `group`
- `limit`
- `offset`

В целом, исходя из примеров выше сложно представить какие плюсы дает новая `ORM`, но самое интересное мы рассмотрим в следующих статьях, а именно:

- `Компилирование кастомных сущностей` для работы со своими или поставляемыми таблицами
- Объект `Query`
- Получение элементов со свойствами
- `fetchObject`, `get`,`set`,`save`
- Отношения
- Кеширование


